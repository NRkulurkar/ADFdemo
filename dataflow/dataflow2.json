{
	"name": "dataflow2",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "empdeptdataset",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"name": "sink1"
				},
				{
					"dataset": {
						"referenceName": "SnowflakeTable1",
						"type": "DatasetReference"
					},
					"name": "sink2"
				}
			],
			"transformations": [
				{
					"name": "split1"
				},
				{
					"name": "FilenameForErrorRows"
				}
			],
			"scriptLines": [
				"source(output(",
				"          EmployeeID as short,",
				"          FirstNameLastName as string,",
				"          Email as string,",
				"          DepartmentID as short,",
				"          DateOfHire as string,",
				"          Salary as integer",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     inferDriftedColumnTypes: true,",
				"     ignoreNoFilesFound: false,",
				"     wildcardPaths:['*emp.csv']) ~> source1",
				"source1 split(isNull(toDate(DateOfHire,'yyyy-mm-dd')),",
				"     equals(dayOfWeek(toDate(DateOfHire,'yyyy-MM-dd')),7) || equals(dayOfWeek(toDate(DateOfHire,'yyyy-MM-dd')),1),",
				"     disjoint: false) ~> split1@(invalidDate, holiday, validDate)",
				"split1@invalidDate derive(FileName = 'emp_csv_date_error_file') ~> FilenameForErrorRows",
				"FilenameForErrorRows sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> sink1",
				"split1@validDate sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          LOANID as string,",
				"          DATAASOF as date,",
				"          INVESTORID as string,",
				"          INVESTORNAME as string,",
				"          BOARDDATE as date,",
				"          LIENPOSITION as decimal(38,0),",
				"          LOANTYPE as decimal(38,0),",
				"          LOANPRODUCT as decimal(38,0),",
				"          LOANPURPOSE as decimal(38,0),",
				"          LASTSTATEMENTDATE as date,",
				"          ORIGINALNOTEDATE as date,",
				"          FEMAAFFECT as decimal(38,0),",
				"          COURTESYPERIOD as decimal(38,0),",
				"          ISATTORNEY as decimal(38,0),",
				"          ANNUALESCROWACCOUNTSTATEMENTDATE as date,",
				"          ESCROWACCOUNTCOMPUTATIONDATE as date,",
				"          ESCROWCANCELDATE as date,",
				"          ISESCROWED as decimal(38,0),",
				"          ESCROWCANCELNOTICEDATE as date,",
				"          EVIDENCEOFINSDATE as date,",
				"          INITIALESCROWSTATEMENTDATE as date,",
				"          ORIGINALESCROWNOTICEDATE as date,",
				"          BORRESCROWCANCELREQDATE as date,",
				"          MBADQ as decimal(38,0),",
				"          LOANSCHEDFORSALE as date,",
				"          ADVERSECREDITBORRNOTICEDATE as date,",
				"          ADVERSECREDITREPORTDATE as date,",
				"          BORRERRORDOCREQDATE as date,",
				"          BORRERRORNOTICEDATE as date,",
				"          BORRERRORNOTICEONPAYOFF as date,",
				"          BORRINFOREQDATE as date,",
				"          BORRNOTICEERRORDATE as date,",
				"          ERRORRESEXTENSION as date,",
				"          ERRORRESDOCDATE as date,",
				"          ERRORRESLETTERDATE as date,",
				"          INFOREQRESPONSEDATE as date,",
				"          NOTICEACKLETTERDATE as date,",
				"          PAYOFFDELIVERYDATE as date,",
				"          PAYOFFREQUESTDATE as date,",
				"          FORCEPLACEDINS as decimal(38,0),",
				"          FORCEPLACEDINSFEEDATE as date,",
				"          FORCEPLACEDINSNOTICE as date,",
				"          FORCEPLACEDINSREMINDER as date,",
				"          FPINSURANCECANCELDATE as date,",
				"          TRANSFER404NOTICEDATE as date,",
				"          GOODBYELETTERDATE as date,",
				"          SERVICERELEASEDATE as date,",
				"          SERVICERELEASESCHEDULEDDATE as date,",
				"          WELCOMELETTERDATE as date,",
				"          WARNINGSTATUS as string,",
				"          DELINQSTATATBOARDING as decimal(38,0),",
				"          DOCUMENTATIONTYPE as decimal(38,0),",
				"          LEGALSTATUS as string,",
				"          PREPAYMENTPENALTYFEE as decimal(38,0),",
				"          INTERESTMETHOD as decimal(38,0),",
				"          LOANAPR as double,",
				"          ADDITIONALDISPUTEINFODATE as date,",
				"          SPOCASSGNDATE as date,",
				"          SCRASTATUS as decimal(38,0),",
				"          SCRASTATUSRUNDATE as date,",
				"          BORRSCRANOTICEDATE as date,",
				"          EFTSCHDNOTDATE as date,",
				"          ETFSCHEDDATE as date,",
				"          BORRFIRSTNAME as string,",
				"          BORRLASTNAME as string,",
				"          MAILINGSTATE as string,",
				"          BORRCURRFICO as decimal(38,0),",
				"          ORIGBORRFICO as decimal(38,0),",
				"          PROPADDRESS1 as string,",
				"          PROPADDRESS2 as string,",
				"          PROPCITY as string,",
				"          PROPSTATE as string,",
				"          PROPZIP as decimal(38,0),",
				"          PROPGEOCODE as decimal(38,0),",
				"          PROPCOUNTY as string,",
				"          PROPVALTYPE as string,",
				"          PROPERTYTYPE as decimal(38,0),",
				"          CURRENTOCCUPANCY as decimal(38,0),",
				"          VALUATIONMETHOD as decimal(38,0),",
				"          ORIGPROPVAL as double,",
				"          CURRENTLTV as decimal(38,0),",
				"          PROPVALNOTICEDATE as date,",
				"          LASTPMISTATEMENTDATE as date,",
				"          BORRPMICANCELREQUEST as date,",
				"          PMICANCELDATE as date,",
				"          PMICANCELNOTICEDATE as date,",
				"          PMICANCELREQUESTDATE as date,",
				"          PMICANCELRESPONSE as date,",
				"          PMICREDITAMOUNT as double,",
				"          PMIFLAG as decimal(38,0),",
				"          PMIPMT as double,",
				"          PMIREFUNDDATE as date,",
				"          LOANAMORTPERIOD as decimal(38,0),",
				"          LASTPAYMENTDUEDATE as date,",
				"          PRINCIPALBALANCE as double,",
				"          NOTOFACCTCLOSETOCREDAGENC as date,",
				"          PAIDOFFDATE as date,",
				"          PITIAMOUNT as double,",
				"          PIAMOUNT as double,",
				"          TIAMOUNT as double,",
				"          PAYMENTCOLLECTEDMTD as double,",
				"          PAYMENTCREDITDATE as date,",
				"          PAYMENTPOSTDATE as date,",
				"          PAYMENTRECEIPTDATE as date,",
				"          PAYMENTDUEDATE as date,",
				"          PAYSTRING as decimal(38,0),",
				"          BORROWERESCROWDEFICIENCYNOTICEDATE as date,",
				"          ESCROWANALYSISDATE as date,",
				"          ESCROWREFUNDDATE as date,",
				"          ESCROWBALANCE as double,",
				"          ESCROWMAKEUPPAYMENT as double,",
				"          ESCROWDEFICIENCY as double,",
				"          ESCROWPAYMENTDUEDATE as date,",
				"          ESCROWSHORTAGE as double,",
				"          ESCROWSURPLUS as double,",
				"          INSURANCEELDDATE as date,",
				"          INSURANCEPAYMENTDATE as date,",
				"          MONTHLYESCROWPMT as double,",
				"          TAXDUEDATE as date,",
				"          TAXPAYMENTDATE as date,",
				"          NEWDELINQUENCYCHARGE as double,",
				"          NEWLATEFEE as double,",
				"          LATECHARGEASSESSEDDATE as date,",
				"          LATECHARGESTOP as date,",
				"          ERRORNOTICEACKDATE as date,",
				"          BORRDQNOTICEDATE as date,",
				"          FPINSURANCEREFUNDDATE as date,",
				"          CREDITEXTENDDATE as date,",
				"          REFUNDDATE as date,",
				"          REFUNDREQDATE as date,",
				"          DELINQUENTNOTICEDATE as date,",
				"          DISPUTERESOLUTION as string,",
				"          ISARM as string,",
				"          SUBSEQUENTINTERESTRATEADJUSTMENTPERIOD as string,",
				"          ARMINDEXCODE as string,",
				"          ARMORIGINALPICHANGEDATE as string,",
				"          NEXTPIADJUSTDATE as date,",
				"          ARMCHANGELETTERDATE as date,",
				"          INDEXAVAILABLELEADTIME as string,",
				"          ARMORIGINALPICHANGELETTERDATE as date,",
				"          BKSTATUS as decimal(38,0),",
				"          BKCHAPTER as decimal(38,0),",
				"          BKSTAGE as decimal(38,0),",
				"          BKFLAG as decimal(38,0),",
				"          MFRHEARINGRESULTS as decimal(38,0),",
				"          CRAMDOWNHEARINGRESULTS as decimal(38,0),",
				"          ADVERSARIALRESULTS as string,",
				"          DAYSINFC as decimal(38,0),",
				"          FCSTAGE as string,",
				"          FCLSCHEDULEDSALEDATE as date,",
				"          FCSCHEDULEDSALEDATE as date,",
				"          FCGOVTFILEDATE as date,",
				"          FCFLAG as decimal(38,0),",
				"          NY1304NOTICEDATE as date,",
				"          LIQUIDATIONTYPE as decimal(38,0),",
				"          LMSTATUS as decimal(38,0),",
				"          BORRSCRAHARDSHIPTYPE as decimal(38,0),",
				"          BORRSCRAHARDSHIPDATE as date,",
				"          BORRINTENTION as string,",
				"          LMDEAL as decimal(38,0),",
				"          LMPROGRAM as decimal(38,0),",
				"          LMDECISION as decimal(38,0),",
				"          LOSSMITAPPACKDATE as date,",
				"          LOSSMITAPPDATE as date,",
				"          LOSSMITAPPEALDATE as date,",
				"          LOSSMITAPPEALDECISIONLETTERDATE as date,",
				"          LOSSMITAPPEALRESPDATE as date,",
				"          LOSSMITAPPEAL as decimal(38,0),",
				"          LOSSMITAPPSTATUS as decimal(38,0),",
				"          LOSSMITASSIGNMENTDATE as date,",
				"          LOSSMITOFFERDATE as date,",
				"          LOSSMITOPTDECISIONDATE as date,",
				"          LOSSMITOPTIONSEXTENSIONLETTERDATE as date,",
				"          LOSSMITOPTIONSLETTERDATE as date,",
				"          LOSSMITPENDINGDOCSNOTICEDATE as date,",
				"          LOSSMITOPTEXTLETTERDATE as date,",
				"          LOSSMITOPTIONDECISIONDATE as date,",
				"          DENIALREASON as decimal(38,0),",
				"          BORR1STCALLDATE as date,",
				"          FORBEARANCESTATUS as decimal(38,0),",
				"          FORBEARANCETYPE as decimal(38,0),",
				"          TRIALSTATUS as decimal(38,0),",
				"          REPAYMENTTYPE as decimal(38,0),",
				"          REPAYMENTSTATUS as decimal(38,0),",
				"          NODLETTERDATE as date,",
				"          BORRRESPTOAPPEALRESPDATE as date,",
				"          REOSTATUS as decimal(38,0),",
				"          REOHOLDREASON as string",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     stageInsert: true) ~> sink2"
			]
		}
	}
}